"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createPersonalizeCookie = void 0;
// © Sitecore Corporation A/S. All rights reserved. Sitecore® is a registered trademark of Sitecore Corporation A/S.
const browser_1 = require("@sitecore-cloudsdk/core/browser");
const internal_1 = require("@sitecore-cloudsdk/core/internal");
const utils_1 = require("@sitecore-cloudsdk/utils");
async function createPersonalizeCookie(personalizeSettings, cloudSDKSettings) {
    const cookiesValuesFromEdgeBrowser = (0, internal_1.getCookiesValuesFromEdgeBrowser)();
    const attributes = (0, internal_1.getDefaultCookieAttributes)(cloudSDKSettings.cookieSettings.expiryDays, cloudSDKSettings.cookieSettings.domain);
    const guestIdCookieValue = (0, utils_1.getCookieValueClientSide)(personalizeSettings.cookieSettings.name.guestId);
    const browserIdCookieValue = (0, utils_1.getCookieValueClientSide)(cloudSDKSettings.cookieSettings.name.browserId);
    if (guestIdCookieValue)
        return;
    else if (cookiesValuesFromEdgeBrowser?.guestId)
        document.cookie = (0, utils_1.createCookieString)(personalizeSettings.cookieSettings.name.guestId, cookiesValuesFromEdgeBrowser.guestId, attributes);
    else if (browserIdCookieValue) {
        const guestIdCookieValue = await (0, browser_1.getGuestId)();
        document.cookie = (0, utils_1.createCookieString)(personalizeSettings.cookieSettings.name.guestId, guestIdCookieValue, attributes);
    }
}
exports.createPersonalizeCookie = createPersonalizeCookie;
